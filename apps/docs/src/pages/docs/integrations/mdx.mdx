import { CodeBlock } from '@/components/code-block/code-block.kita';
import { DocsLayout } from '@/layouts/docs-layout';

export const layout = DocsLayout;

export const getMetadata = () => ({
  title: 'Docs | MDX Integration',
  description: 'Learn how to use the MDX integration with Ecopages',
});

# MDX Integration

The `@ecopages/mdx` package brings the power of [MDX](https://mdxjs.com/) (Markdown with JSX) to Ecopages. It allows you to write content-rich pages using Markdown syntax while seamlessly embedding interactive components.

## Installation

<CodeBlock>
```bash
bunx jsr add @ecopages/mdx
```
</CodeBlock>

## Usage

To start using MDX, add the `mdxPlugin` to your Ecopages configuration.

<CodeBlock>
```typescript
import { ConfigBuilder } from '@ecopages/core';
import { mdxPlugin } from '@ecopages/mdx';

const config = await new ConfigBuilder()
	.setRootDir(import.meta.dir)
	.setBaseUrl(import.meta.env.ECOPAGES_BASE_URL)
	.setIntegrations([mdxPlugin()])
	.build();

export default config;
```
</CodeBlock>

### Implicit React Support

By default, the MDX plugin is configured to use **React** as the JSX runtime. This means you do not need to manually configure React support or import React in every MDX file. The plugin handles the necessary imports and environment setup for you.

## Features

### Layouts

You can define a wrapper layout for your MDX content by exporting a `layout` component from your MDX file. This is useful for wrapping your content in a consistent page structure.

<CodeBlock>
```mdx
import { BaseLayout } from '@/layouts/base-layout';

export const layout = BaseLayout;

# Hello World

This content will be wrapped by the BaseLayout component.
```
</CodeBlock>

### Metadata

Page metadata (like title and description) can be defined by exporting a `getMetadata` function, similar to standard TypeScript pages.

<CodeBlock>
```mdx
export const getMetadata = () => ({
  title: 'My MDX Page',
  description: 'This is a description for the MDX page.'
});

# Content

Page content goes here...
```
</CodeBlock>

### Using Components

You can import and use components directly in your MDX files. Remember to export a `config` object if your components have dependencies that need to be resolved.

<CodeBlock>
```mdx
import { Card } from '@/components/card';
import { BaseLayout } from '@/layouts/base-layout';

export const layout = BaseLayout;

export const config = {
  dependencies: {
    components: [Card, BaseLayout],
  },
};

# Dashboard

<Card title="Analytics" value="100%" />
<Card title="Users" value="500" />
```
</CodeBlock>

## Configuration

The `mdxPlugin` accepts standard MDX compile options.

<CodeBlock>
```typescript
mdxPlugin({
  compilerOptions: {
    remarkPlugins: [],
    rehypePlugins: [],
    // You can also change the JSX runtime if needed (default: 'react')
    jsxImportSource: 'react', 
  }
})
```
</CodeBlock>

## Integration with Other Frameworks

While React is the default, MDX can be used with other frameworks like Lit, though it may require specific configuration or client-side rendering considerations.

<div class="banner banner--alert mt-4" role="alert">
	<p class="banner__title">Non-React Frameworks</p>
	<p>
		When using non-React frameworks inside MDX (e.g., Lit components), they might not be server-side rendered by the MDX renderer and will likely relying on client-side hydration.
	</p>
</div>

For example, using Lit components:

<CodeBlock>
```typescript
import { litPlugin } from '@ecopages/lit';

// ... inside config
.setIntegrations([mdxPlugin(), litPlugin()])
```
</CodeBlock>

In your MDX file, standard Lit components will work as custom elements (once registered via their import).
